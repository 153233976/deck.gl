<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <title>deck.gl GeoJsonLayer (Path) Example | WebGL visualization</title>
    <link rel="stylesheet" id="font-link" href="https://d1a3f4spazzrp4.cloudfront.net/uber-fonts/3.1.0/refresh.css">

    <meta name="description" content="WebGL-based visualization examples using deck.gl">

    <link rel="icon" type="img/ico" href="https://uber.github.io/deck.gl/favicon.ico">

    <!-— facebook open graph tags -->
    <meta property="og:url" content="https://uber.github.io/deck.gl/showcases/gallery" />
    <meta property="og:title" content="deck.gl GeoJsonLayer (Path) Example | WebGL visualization" />
    <meta property="og:description" content="WebGL-based visualization examples using deck.gl" />
    <meta property="og:site_name" content="deck.gl" />
    <meta property="og:image" content="https://uber.github.io/deck.gl/showcases/gallery/images/highway.jpg" />
    <meta property="og:image:type" content="image/jpeg" />
    <meta property="og:image:width" content="800" />
    <meta property="og:image:height" content="480" />
    
    <!-— twitter card tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@uber">
    <meta name="twitter:creator" content="@uber">
    <meta name="twitter:title" content="deck.gl GeoJsonLayer (Path) Example | WebGL visualization">
    <meta name="twitter:description" content="WebGL-based visualization examples using deck.gl">
    <meta name="twitter:image" content="https://uber.github.io/deck.gl/showcases/gallery/images/highway.jpg" />

    <style>
      body {font-family: ff-clan-web-pro, "Helvetica Neue", Helvetica, sans-serif !important; font-size: 12px;}
      #container {width: 100%; max-width: 960px; padding: 40px 12px; margin: auto;}
      #source {margin: 12px 0; border: solid 1px #ccc; padding: 24px}
      #links {margin: 12px 0;}
      #links a {text-decoration: none; color: #444;}
      #links a:hover {color: #08f;}
    </style>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-7157694-83', 'auto');
  ga('send', 'pageview');
</script>
  </head>
  <body>
    <div id="container">
      <h1>deck.gl GeoJsonLayer (Path) Example</h1>
      <div id="links">
        <a href="./">↩ Back to Gallery</a>
      </div>
      <h2>Demo</h2>
      <iframe width="100%" height="450" frameborder="0" src="data:text/html;charset=utf-8,%3Chtml%3E%0A%20%20%3Chead%3E%0A%20%20%20%20%3Ctitle%3Edeck.gl%20GeoJsonLayer%20(Path)%20Example%3C/title%3E%0A%0A%20%20%20%20%3Cscript%20src=%22https://unpkg.com/deck.gl@%5E6.0.0/deckgl.min.js%22%3E%3C/script%3E%0A%20%20%20%20%3Cscript%20src=%22https://d3js.org/d3.v5.min.js%22%3E%3C/script%3E%0A%0A%20%20%20%20%3Cscript%20src=%22https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.js%22%3E%3C/script%3E%0A%0A%20%20%20%20%3Cstyle%20type=%22text/css%22%3E%0A%20%20%20%20%20%20body%20%7B%0A%20%20%20%20%20%20%20%20width:%20100vw;%0A%20%20%20%20%20%20%20%20height:%20100vh;%0A%20%20%20%20%20%20%20%20margin:%200;%0A%20%20%20%20%20%20%20%20overflow:%20hidden;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20#tooltip:empty%20%7B%0A%20%20%20%20%20%20%20%20display:%20none;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20#tooltip%20%7B%0A%20%20%20%20%20%20%20%20font-family:%20Helvetica,%20Arial,%20sans-serif;%0A%20%20%20%20%20%20%20%20font-size:%2011px;%0A%20%20%20%20%20%20%20%20position:%20absolute;%0A%20%20%20%20%20%20%20%20padding:%204px;%0A%20%20%20%20%20%20%20%20margin:%208px;%0A%20%20%20%20%20%20%20%20background:%20rgba(0,%200,%200,%200.8);%0A%20%20%20%20%20%20%20%20color:%20#fff;%0A%20%20%20%20%20%20%20%20max-width:%20300px;%0A%20%20%20%20%20%20%20%20font-size:%2010px;%0A%20%20%20%20%20%20%20%20z-index:%209;%0A%20%20%20%20%20%20%20%20pointer-events:%20none;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20#options%20%7B%0A%20%20%20%20%20%20%20%20position:%20fixed;%0A%20%20%20%20%20%20%20%20z-index:%201;%0A%20%20%20%20%20%20%20%20background:%20#fff;%0A%20%20%20%20%20%20%20%20top:%200;%0A%20%20%20%20%20%20%20%20left:%200;%0A%20%20%20%20%20%20%20%20margin:%2020px;%0A%20%20%20%20%20%20%20%20padding:%2012px;%0A%20%20%20%20%20%20%20%20font-size:%2011px;%0A%20%20%20%20%20%20%20%20box-shadow:%200%200%208px%20rgba(0,0,0,0.3);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%3C/style%3E%0A%20%20%3C/head%3E%0A%0A%20%20%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id=%22options%22%3E%3C/div%3E%0A%20%20%20%20%3Cdiv%20id=%22tooltip%22%3E%3C/div%3E%0A%20%20%3C/body%3E%0A%0A%20%20%3Cscript%20type=%22text/javascript%22%3E%0A%0A%20%20const%20%7BDeckGL,%20GeoJsonLayer%7D%20=%20deck;%0A%0A%20%20const%20COLOR_SCALE%20=%20d3.scaleThreshold()%0A%20%20%20%20.domain(%5B0,%204,%208,%2012,%2020,%2032,%2052,%2084,%20136,%20220%5D)%0A%20%20%20%20.range(%5B%0A%20%20%20%20%20%20%5B26,%20152,%2080%5D,%0A%20%20%20%20%20%20%5B102,%20189,%2099%5D,%0A%20%20%20%20%20%20%5B166,%20217,%20106%5D,%0A%20%20%20%20%20%20%5B217,%20239,%20139%5D,%0A%20%20%20%20%20%20%5B255,%20255,%20191%5D,%0A%20%20%20%20%20%20%5B254,%20224,%20139%5D,%0A%20%20%20%20%20%20%5B253,%20174,%2097%5D,%0A%20%20%20%20%20%20%5B244,%20109,%2067%5D,%0A%20%20%20%20%20%20%5B215,%2048,%2039%5D,%0A%20%20%20%20%20%20%5B168,%200,%200%5D%0A%20%20%20%20%5D);%0A%0A%20%20const%20WIDTH_SCALE%20=%20d3.scaleLinear()%0A%20%20%20%20.clamp(true)%0A%20%20%20%20.domain(%5B0,%20200%5D)%0A%20%20%20%20.range(%5B10,%202000%5D);%0A%0A%20%20let%20accidents%20=%20%7B%7D;%0A%20%20let%20fatalities%20=%20%7B%7D;%0A%20%20let%20year%20=%20-1;%0A%0A%20%20const%20deckgl%20=%20new%20deck.DeckGL(%7B%0A%20%20%20%20viewState:%20%7B%0A%20%20%20%20%20%20longitude:%20-100,%0A%20%20%20%20%20%20latitude:%2038,%0A%20%20%20%20%20%20zoom:%204,%0A%20%20%20%20%20%20pitch:%200,%0A%20%20%20%20%20%20minZoom:%202,%0A%20%20%20%20%20%20maxZoom:%208%0A%20%20%20%20%7D,%0A%20%20%20%20mapboxApiAccessToken:%20'pk.eyJ1IjoidWJlcmRhdGEiLCJhIjoiY2pwY3owbGFxMDVwNTNxcXdwMms2OWtzbiJ9.1PPVl0VLUQgqrosrI2nUhg',%0A%20%20%20%20mapStyle:%20'mapbox://styles/mapbox/dark-v9',%0A%20%20%20%20pickingRadius:%205,%0A%20%20%20%20layers:%20%5B%5D%0A%20%20%7D);%0A%0A%20%20d3.csv('https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/highway/accidents.csv')%0A%20%20%20%20.then(accidents%20=%3E%20%7B%0A%0A%20%20%20%20//%20sort%20accident%20data%0A%20%20%20%20incidents%20=%20%7B%7D;%0A%20%20%20%20fatalities%20=%20%7B%7D;%0A%0A%20%20%20%20accidents.forEach(a%20=%3E%20%7B%0A%20%20%20%20%20%20const%20r%20=%20(incidents%5Ba.year%5D%20=%20incidents%5Ba.year%5D%20%7C%7C%20%7B%7D);%0A%20%20%20%20%20%20const%20f%20=%20(fatalities%5Ba.year%5D%20=%20fatalities%5Ba.year%5D%20%7C%7C%20%7B%7D);%0A%20%20%20%20%20%20const%20key%20=%20getKey(a);%0A%20%20%20%20%20%20r%5Bkey%5D%20=%20a.incidents;%0A%20%20%20%20%20%20f%5Bkey%5D%20=%20a.fatalities;%0A%20%20%20%20%7D);%0A%0A%20%20%20%20year%20=%20accidents%5B0%5D.year;%0A%20%20%20%20%0A%20%20%20%20initInputs(d3.select('#options'));%0A%20%20%20%20redraw();%0A%20%20%7D);%0A%0A%20%20//%20Update%20deck.gl%20layers%0A%20%20function%20redraw()%20%7B%0A%0A%20%20%20%20const%20layers%20=%20%5B%0A%20%20%20%20%20%20new%20GeoJsonLayer(%7B%0A%20%20%20%20%20%20%20%20id:%20'geojson',%0A%20%20%20%20%20%20%20%20data:%20'https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/highway/roads.json',%0A%20%20%20%20%20%20%20%20opacity:%201,%0A%20%20%20%20%20%20%20%20stroked:%20false,%0A%20%20%20%20%20%20%20%20filled:%20false,%0A%20%20%20%20%20%20%20%20lineWidthMinPixels:%201,%0A%20%20%20%20%20%20%20%20parameters:%20%7B%0A%20%20%20%20%20%20%20%20%20%20depthTest:%20false%0A%20%20%20%20%20%20%20%20%7D,%0A%0A%20%20%20%20%20%20%20%20getLineColor:%20getLineColor,%0A%20%20%20%20%20%20%20%20getLineWidth:%20getLineWidth,%0A%0A%20%20%20%20%20%20%20%20pickable:%20true,%0A%20%20%20%20%20%20%20%20onHover:%20updateTooltip,%0A%0A%20%20%20%20%20%20%20%20updateTriggers:%20%7B%0A%20%20%20%20%20%20%20%20%20%20getLineColor:%20%7Byear%7D,%0A%20%20%20%20%20%20%20%20%20%20getLineWidth:%20%7Byear%7D%0A%20%20%20%20%20%20%20%20%7D,%0A%0A%20%20%20%20%20%20%20%20transitions:%20%7B%0A%20%20%20%20%20%20%20%20%20%20getLineColor:%201000,%0A%20%20%20%20%20%20%20%20%20%20getLineWidth:%201000%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D)%0A%20%20%20%20%5D;%0A%0A%20%20%20%20deckgl.setProps(%7Blayers%7D);%0A%20%20%7D%0A%0A%20%20function%20getKey(%7Bstate,%20type,%20id%7D)%20%7B%0A%20%20%20%20return%20%60$%7Bstate%7D-$%7Btype%7D-$%7Bid%7D%60;%0A%20%20%7D%0A%0A%20%20function%20getLineColor(f)%20%7B%0A%20%20%20%20if%20(!fatalities%5Byear%5D)%20%7B%0A%20%20%20%20%20%20return%20%5B200,%20200,%20200%5D;%0A%20%20%20%20%7D%0A%20%20%20%20const%20key%20=%20getKey(f.properties);%0A%20%20%20%20const%20fatalitiesPer1KMile%20=%20((fatalities%5Byear%5D%5Bkey%5D%20%7C%7C%200)%20/%20f.properties.length)%20*%201000;%0A%20%20%20%20return%20COLOR_SCALE(fatalitiesPer1KMile);%0A%20%20%7D%0A%0A%20%20function%20getLineWidth(f)%20%7B%0A%20%20%20%20if%20(!incidents%5Byear%5D)%20%7B%0A%20%20%20%20%20%20return%2010;%0A%20%20%20%20%7D%0A%20%20%20%20const%20key%20=%20getKey(f.properties);%0A%20%20%20%20const%20incidentsPer1KMile%20=%20((incidents%5Byear%5D%5Bkey%5D%20%7C%7C%200)%20/%20f.properties.length)%20*%201000;%0A%20%20%20%20return%20WIDTH_SCALE(incidentsPer1KMile);%0A%20%20%7D%0A%0A%20%20/*%20UI%20*/%0A%0A%20%20function%20initInputs(container)%20%7B%0A%20%20%20%20const%20inputValue%20=%20container.append('div').text(%60YEAR:%20$%7Byear%7D%60);%0A%0A%20%20%20%20const%20yearRange%20=%20Object.keys(incidents).map(Number);%0A%0A%20%20%20%20const%20input%20=%20container.append('input').attr('type',%20'range')%0A%20%20%20%20%20%20.attr('min',%20d3.min(yearRange))%0A%20%20%20%20%20%20.attr('max',%20d3.max(yearRange))%0A%20%20%20%20%20%20.attr('step',%205)%0A%20%20%20%20%20%20.attr('value',%20year)%0A%20%20%20%20%20%20.on('input',%20()%20=%3E%20%7B%0A%20%20%20%20%20%20%20%20year%20=%20input.property('value');%0A%20%20%20%20%20%20%20%20inputValue.text(%60YEAR:%20$%7Byear%7D%60);%0A%20%20%20%20%20%20%20%20redraw();%0A%20%20%20%20%20%20%7D);%0A%20%20%7D%0A%0A%20%20function%20updateTooltip(info)%20%7B%0A%20%20%20%20const%20tooltip%20=%20d3.select('#tooltip');%0A%20%20%20%20const%20props%20=%20info.object%20?%20info.object.properties%20:%20null;%0A%20%20%20%20let%20content%20=%20'';%0A%0A%20%20%20%20if%20(props)%20%7B%0A%20%20%20%20%20%20const%20key%20=%20getKey(props);%0A%20%20%20%20%20%20const%20r%20=%20incidents%5Byear%5D%5Bkey%5D;%0A%20%20%20%20%20%20const%20f%20=%20fatalities%5Byear%5D%5Bkey%5D;%0A%0A%20%20%20%20%20%20let%20content%20=%20%60%3Cbig%3E$%7Bprops.name%7D%20($%7Bprops.state%7D)%3C/big%3E%60;%0A%20%20%20%20%20%20if%20(r)%20%7B%0A%20%20%20%20%20%20%20%20content%20+=%20%60%0A%20%20%3Cdiv%3E%0A%20%20%20%20%3Cb%3E$%7Bf%7D%3C/b%3E%20people%20died%20in%0A%20%20%20%20%3Cb%3E$%7Br%7D%3C/b%3E%20crashes%0A%20%20%20%20on%20$%7Bprops.type%20===%20'SR'%20?%20props.state%20:%20props.type%7D-$%7Bprops.id%7D%0A%20%20%20%20in%20%3Cb%3E$%7Byear%7D%3C/b%3E%0A%20%20%3C/div%3E%60;%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20content%20+=%20%60%3Cdiv%3Eno%20accidents%20recorded%20in%20%3Cb%3E$%7Byear%7D%3C/b%3E%3C/div%3E%60;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20tooltip.style('display',%20'block').style('left',%20info.x).style('top',%20info.y).html(content);%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20tooltip.style('display',%20'none');%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%3C/script%3E%0A%3C/html%3E" ></iframe>
      <h2>Source</h2>
      <div id="source">
        <code class="prettyprint">&lt;html&gt;<br/>&nbsp;&nbsp;&lt;head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;deck.gl GeoJsonLayer (Path) Example&lt;/title&gt;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;script src="https://unpkg.com/deck.gl@^6.0.0/deckgl.min.js"&gt;&lt;/script&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;script src="https://d3js.org/d3.v5.min.js"&gt;&lt;/script&gt;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;script src="https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.js"&gt;&lt;/script&gt;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;style type="text/css"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width: 100vw;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height: 100vh;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin: 0;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflow: hidden;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#tooltip:empty {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;display: none;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#tooltip {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family: Helvetica, Arial, sans-serif;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size: 11px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;position: absolute;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding: 4px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin: 8px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;background: rgba(0, 0, 0, 0.8);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color: #fff;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max-width: 300px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size: 10px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z-index: 9;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointer-events: none;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#options {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;position: fixed;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z-index: 1;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;background: #fff;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;top: 0;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left: 0;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin: 20px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding: 12px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size: 11px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;box-shadow: 0 0 8px rgba(0,0,0,0.3);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;<br/>&nbsp;&nbsp;&lt;/head&gt;<br/><br/>&nbsp;&nbsp;&lt;body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;div id="options"&gt;&lt;/div&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;div id="tooltip"&gt;&lt;/div&gt;<br/>&nbsp;&nbsp;&lt;/body&gt;<br/><br/>&nbsp;&nbsp;&lt;script type="text/javascript"&gt;<br/><br/>&nbsp;&nbsp;const {DeckGL, GeoJsonLayer} = deck;<br/><br/>&nbsp;&nbsp;const COLOR_SCALE = d3.scaleThreshold()<br/>&nbsp;&nbsp;&nbsp;&nbsp;.domain([0, 4, 8, 12, 20, 32, 52, 84, 136, 220])<br/>&nbsp;&nbsp;&nbsp;&nbsp;.range([<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[26, 152, 80],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[102, 189, 99],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[166, 217, 106],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[217, 239, 139],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[255, 255, 191],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[254, 224, 139],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[253, 174, 97],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[244, 109, 67],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[215, 48, 39],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[168, 0, 0]<br/>&nbsp;&nbsp;&nbsp;&nbsp;]);<br/><br/>&nbsp;&nbsp;const WIDTH_SCALE = d3.scaleLinear()<br/>&nbsp;&nbsp;&nbsp;&nbsp;.clamp(true)<br/>&nbsp;&nbsp;&nbsp;&nbsp;.domain([0, 200])<br/>&nbsp;&nbsp;&nbsp;&nbsp;.range([10, 2000]);<br/><br/>&nbsp;&nbsp;let accidents = {};<br/>&nbsp;&nbsp;let fatalities = {};<br/>&nbsp;&nbsp;let year = -1;<br/><br/>&nbsp;&nbsp;const deckgl = new deck.DeckGL({<br/>&nbsp;&nbsp;&nbsp;&nbsp;viewState: {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;longitude: -100,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;latitude: 38,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zoom: 4,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pitch: 0,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minZoom: 2,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxZoom: 8<br/>&nbsp;&nbsp;&nbsp;&nbsp;},<br/>&nbsp;&nbsp;&nbsp;&nbsp;mapboxApiAccessToken: '&lt;mapbox-access-token&gt;',<br/>&nbsp;&nbsp;&nbsp;&nbsp;mapStyle: 'mapbox://styles/mapbox/dark-v9',<br/>&nbsp;&nbsp;&nbsp;&nbsp;pickingRadius: 5,<br/>&nbsp;&nbsp;&nbsp;&nbsp;layers: []<br/>&nbsp;&nbsp;});<br/><br/>&nbsp;&nbsp;d3.csv('https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/highway/accidents.csv')<br/>&nbsp;&nbsp;&nbsp;&nbsp;.then(accidents =&gt; {<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;// sort accident data<br/>&nbsp;&nbsp;&nbsp;&nbsp;incidents = {};<br/>&nbsp;&nbsp;&nbsp;&nbsp;fatalities = {};<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;accidents.forEach(a =&gt; {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const r = (incidents[a.year] = incidents[a.year] || {});<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const f = (fatalities[a.year] = fatalities[a.year] || {});<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const key = getKey(a);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r[key] = a.incidents;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f[key] = a.fatalities;<br/>&nbsp;&nbsp;&nbsp;&nbsp;});<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;year = accidents[0].year;<br/>&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;initInputs(d3.select('#options'));<br/>&nbsp;&nbsp;&nbsp;&nbsp;redraw();<br/>&nbsp;&nbsp;});<br/><br/>&nbsp;&nbsp;// Update deck.gl layers<br/>&nbsp;&nbsp;function redraw() {<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;const layers = [<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new GeoJsonLayer({<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id: 'geojson',<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data: 'https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/highway/roads.json',<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opacity: 1,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stroked: false,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filled: false,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lineWidthMinPixels: 1,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameters: {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;depthTest: false<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getLineColor: getLineColor,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getLineWidth: getLineWidth,<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pickable: true,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;onHover: updateTooltip,<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;updateTriggers: {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getLineColor: {year},<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getLineWidth: {year}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transitions: {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getLineColor: 1000,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getLineWidth: 1000<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})<br/>&nbsp;&nbsp;&nbsp;&nbsp;];<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;deckgl.setProps({layers});<br/>&nbsp;&nbsp;}<br/><br/>&nbsp;&nbsp;function getKey({state, type, id}) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;return `${state}-${type}-${id}`;<br/>&nbsp;&nbsp;}<br/><br/>&nbsp;&nbsp;function getLineColor(f) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;if (!fatalities[year]) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [200, 200, 200];<br/>&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;const key = getKey(f.properties);<br/>&nbsp;&nbsp;&nbsp;&nbsp;const fatalitiesPer1KMile = ((fatalities[year][key] || 0) / f.properties.length) * 1000;<br/>&nbsp;&nbsp;&nbsp;&nbsp;return COLOR_SCALE(fatalitiesPer1KMile);<br/>&nbsp;&nbsp;}<br/><br/>&nbsp;&nbsp;function getLineWidth(f) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;if (!incidents[year]) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 10;<br/>&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;const key = getKey(f.properties);<br/>&nbsp;&nbsp;&nbsp;&nbsp;const incidentsPer1KMile = ((incidents[year][key] || 0) / f.properties.length) * 1000;<br/>&nbsp;&nbsp;&nbsp;&nbsp;return WIDTH_SCALE(incidentsPer1KMile);<br/>&nbsp;&nbsp;}<br/><br/>&nbsp;&nbsp;/* UI */<br/><br/>&nbsp;&nbsp;function initInputs(container) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;const inputValue = container.append('div').text(`YEAR: ${year}`);<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;const yearRange = Object.keys(incidents).map(Number);<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;const input = container.append('input').attr('type', 'range')<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.attr('min', d3.min(yearRange))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.attr('max', d3.max(yearRange))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.attr('step', 5)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.attr('value', year)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.on('input', () =&gt; {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;year = input.property('value');<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inputValue.text(`YEAR: ${year}`);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;redraw();<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br/>&nbsp;&nbsp;}<br/><br/>&nbsp;&nbsp;function updateTooltip(info) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;const tooltip = d3.select('#tooltip');<br/>&nbsp;&nbsp;&nbsp;&nbsp;const props = info.object ? info.object.properties : null;<br/>&nbsp;&nbsp;&nbsp;&nbsp;let content = '';<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;if (props) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const key = getKey(props);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const r = incidents[year][key];<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const f = fatalities[year][key];<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let content = `&lt;big&gt;${props.name} (${props.state})&lt;/big&gt;`;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (r) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content += `<br/>&nbsp;&nbsp;&lt;div&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;${f}&lt;/b&gt; people died in<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;${r}&lt;/b&gt; crashes<br/>&nbsp;&nbsp;&nbsp;&nbsp;on ${props.type === 'SR' ? props.state : props.type}-${props.id}<br/>&nbsp;&nbsp;&nbsp;&nbsp;in &lt;b&gt;${year}&lt;/b&gt;<br/>&nbsp;&nbsp;&lt;/div&gt;`;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content += `&lt;div&gt;no accidents recorded in &lt;b&gt;${year}&lt;/b&gt;&lt;/div&gt;`;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tooltip.style('display', 'block').style('left', info.x).style('top', info.y).html(content);<br/>&nbsp;&nbsp;&nbsp;&nbsp;} else {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tooltip.style('display', 'none');<br/>&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;}<br/><br/>&nbsp;&nbsp;&lt;/script&gt;<br/>&lt;/html&gt;</code>
      </div>
    </div>
  </body>
</html>